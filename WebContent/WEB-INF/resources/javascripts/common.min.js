$(function(){$("form").on("submit",function(){$("#waitModal").modal({backdrop:"static"})});$("a").on("click",function(){$("#waitModal").modal({backdrop:"static"})});$(".downLoadCheckOut").on("click",function(){tableToExcel($(this).val())})});var tableToExcel=(function(){var uri="data:application/vnd.ms-excel;base64,",template='<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',base64=function(s){return window.btoa(unescape(encodeURIComponent(s)))},format=function(s,c){return s.replace(/{(\w+)}/g,function(m,p){return c[p]})};return function(table,name){if(!table.nodeType){table=document.getElementById(table)}var ctx={worksheet:name||"Worksheet",table:table.innerHTML};window.location.href=uri+base64(format(template,ctx))}})();function AjaxForGet(targetUrl,param,func){$.ajax({timeout:5000,type:"GET",url:targetUrl,data:param||"",success:function(data){func(JSON.parse(data))}})}function isIdCard(idNum){var nums=idNum.split("");var checkNums=new Array("7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2");var realNums=new Array("1","0","X","9","8","7","6","5","4","3","2");var addResult=0;for(var i=0;i<nums.length-1;i++){addResult+=nums[i]*checkNums[i]}var result=addResult%11;if(realNums[result].toUpperCase()!=nums[17].toUpperCase()){return false}return true}function necessaryCheck(inputNames,radioNames,selectNames){if(undefined==inputNames||null==inputNames){}else{for(var nameI=0;nameI<inputNames.length;nameI++){var $_checkItem=$("input[name='"+inputNames[nameI]+"']");if(""==$_checkItem.val().trim()){$_checkItem.parents(".form-group").addClass("has-error");new Confirm({"message":"有必填项没有填写","type":"alert","focusTarget":inputNames[nameI]});return false}}}if(undefined==radioNames||null==radioNames){}else{for(var nameI=0;nameI<radioNames.length;nameI++){var $_checkItem=$("input[name='"+radioNames[nameI]+"']:checked");if(undefined==$_checkItem.val()){$_checkItem.parents(".form-group").addClass("has-error");new Confirm({"message":"有必填项没有填写","type":"alert","focusTarget":radioNames[nameI]});return false}}}if(undefined==selectNames||null==selectNames){}else{for(var nameI=0;nameI<selectNames.length;nameI++){var $_checkItem=$("select[name='"+selectNames[nameI]+"']");if(""==$_checkItem.val()){$_checkItem.parents(".form-group").addClass("has-error");new Confirm({"message":"有必填项没有填写","type":"alert","focusTarget":selectNames[nameI]});return false}}}return true}function lengthCheck(item,length){if(length<item.val().length){item.parents(".form-group").addClass("has-error");return false}}function addMessage(item,content){$_messageBox=$("<div class='col-xs-2 col-sm-2 errorMessages'>"+"  <font color='red' ><p>"+content+"</p></font>"+"</div>").insertAfter(item.parents(".form-group"))}function removeMessage(item){$_parentItem=item.parents(".form-group");$_messageBox=$_parentItem.nextAll(".errorMessages").remove()}function timeCheck(item){var reg=/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/;var regExp=new RegExp(reg);if(!regExp.test(item.val())){return false}return true}var Confirm=function(options){this.sureBtn=null;this.cancelBtn=null;this.textInput=null;this.contain=null;this.configs={"type":"confirm","title":"","message":"这是一个提示","cancelCallBack":"","sureCallBack":"","focusTarget":""};options&&this.extend(this.configs,options);this.init();this.sureBtn&&this.addEvent(this.sureBtn,"click",this.btnClick.bind(this));this.cancelBtn&&this.addEvent(this.cancelBtn,"click",this.btnClick.bind(this));$("#ConfirmModal").modal({backdrop:"static"})};Confirm.prototype={init:function(){var config=this.configs;this.contain=$('<div role="dialog" aria-labelledby="ConfirmModalLabel" tabindex="-1" class="modal fade" id="ConfirmModal">'+'<div class="modal-dialog" role ="document">'+'<div class="modal-content">'+'<div class="modal-body"></div>'+'<div class="modal-footer"></div>'+"</div>"+"</div>"+"</div>");this.contain.find(".modal-body").append($("<p>"+config.message+"</p>"));this.contain.appendTo($("body"));switch(config.type){case"confirm":this.contain.find(".modal-footer").append($('<button type="button" data-dismiss="modal" class="btn btn-default" id="ConfirmModalCancel">取消</buttion>'));this.contain.find(".modal-footer").append($('<button type="button" data-dismiss="modal" class="btn btn-primary" id="ConfirmModalSure">确定</buttion>'));this.sureBtn=this.contain.find(".btn-primary")[0];this.cancelBtn=this.contain.find(".btn-default")[0];break;case"alert":this.contain.find(".modal-footer").append($('<button type="button" data-dismiss="modal" class="btn btn-primary" id="ConfirmModalSure">确定</buttion>'));this.sureBtn=this.contain.find(".btn-primary")[0];break}},extend:function(oldObj,newObj){for(var key in newObj){oldObj[key]=newObj[key]}return oldObj},addEvent:function(el,type,callBack){if(el.attachEvent){el.attachEvent("on"+type,callBack)}else{el.addEventListener(type,callBack,false)}},btnClick:function(e){e=e||event;var _this=this,_tarId=e.target.id,_configs=this.configs;switch(_tarId){case"ConfirmModalCancel":_this.close();
_configs.cancelCallBack&&_configs.cancelCallBack();break;case"ConfirmModalSure":_this.close();_configs.sureCallBack&&_configs.sureCallBack();break}},close:function(){$("body").removeClass("modal-open");this.contain.next(".modal-backdrop").remove();this.contain.remove();$("input[name='"+this.configs.focusTarget+"']").focus()}};